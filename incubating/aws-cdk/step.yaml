kind: step-type
version: '1.0'
metadata:
  name: cf-support/aws-cdk
  version: 1.0.0-hack
  isPublic: false
  description: Integration with AWS Cloud Development Kit.
  sources:
    - https://github.com/codefresh-io/steps/tree/master/incubating/aws-cdk
  stage: incubating
  maintainers:
    - name: Francisco Cocozza,Laurent Rochette, LUkas Goodfellow
    - email: francisco@codefresh.io, laurent.rochette@codefresh.io, lukas.goodfellow@codefresh.io
  categories:
    - utilities
    - deployment
    - build
  official: false
  tags: []
  icon:
    type: image
    url: https://cdn.jsdelivr.net/gh/codefresh-io/steps/incubating/aws-cdk/icon.png
  examples:
    - description: aws-cdk
      workflow:
        AwsCDKSynth:
          title: "Build the app"
          type: aws-cdk
          arguments:
            ARG1: TBD
            ARG2: TBD
spec:
  arguments: |-
    {
      "definitions": {},
      "$schema": "http://json-schema.org/draft-07/schema#",
      "type": "object",
      "additionalProperties": true,
      "patterns": [],
      "required": [
        "action",
        "language"
      ],
      "properties": {
        "action": {
          "type": "string",
          "description": "The CDK operation to execute. Value can be synth, bootstrap, deploy, diff, list, destroy, freestyle"
        },
        "project_dir": {
          "type": "string",
          "description": "the path where the CDK application is located"
        },
        "language": {
          "type": "string",
          "description": "The language of the applciation. Default is "
        }
      }
    }
  steps:
    planner:
      name: aws-cdk-planner
      title: create the bash file to execute
      image: lrochette/cdk-planner
        - env
    execute-tyupescript:
      name: aws-cdk-executor-typescript
      title: execute commands for Typescript
      image: lrochette/cdk-executor-typescript
      commands:
        ./cdk-executor-typescript.sh
  # stepsTemplate: |-
  #   aws-cdk:
  #     name: aws-cdk
  #     image: lrochette/aws-cdk
  #     environment:
  #     [[ range $key, $val := .Arguments ]]
  #       - '[[ $key ]]=[[ $val ]]'
  #     [[- end ]]
  #     commands:
  #       - env
  # delimiters:
  #   left: '[['
  #   right: ']]'
